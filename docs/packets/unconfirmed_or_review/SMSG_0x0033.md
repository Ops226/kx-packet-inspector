# SMSG 0x0033 — Conditional Notify + Finalize

Status: Confirmed (code-backed)

Dispatch Path:
- Dispatcher: FUN_14025DA50, case 0x33 (index = opcode − 0x2B)
- Schema: &DAT_142512E70 → passed to FUN_140FD4D50 (typed arg builder)
- Handler code slice (addresses approximate): 0x14025DEBD..0x14025E046

Behavior Summary:
- Parses tuple via FUN_140FD4D50(&DAT_142512E70) → RBX.
- Locates an object/record from keys in the tuple. If not found, returns.
- Optional queued notification: if *(u32*)(RBX + 0x02) != 0, enqueues a callback via FUN_140250F30(&ctx->+0x88, &LAB_1402536F8, obj, *(u32*)(RBX + 0x02)).
- Finalize: calls an object finalize/commit path (vtable+0x170 or direct helper e.g., FUN_140256DC0) using fields from the tuple (e.g., RBX + 0x0A/..).
- Bounded branching: simple guards; no deep loops.

Key Instructions (evidence):
- tuple = FUN_140FD4D50(&DAT_142512E70)
- obj = lookup from tuple keys (ctx at param_1 or derived); if (!obj) return
- if (*(u32*)(tuple + 0x02) != 0) → FUN_140250F30(&ctx->+0x88, &LAB_1402536F8, obj, *(u32*)(tuple + 0x02))
- finalize via object method or FUN_140256DC0 with tuple-sourced args

Field Layout (inferred from handler offsets):
- +0x02: u32 count/flag; when non-zero triggers notification enqueue
- +0x0A…: additional material used by finalize call (IDs, parameters)
- Lookup keys pulled from early tuple fields (pointers/u16*), consistent with neighboring cases

Wire Structure (first-pass, from BuildArgs semantics + offsets used)

```cpp
#pragma pack(push, 1)

struct Smsg_0033_Tuple {
    // Leading keys used for object lookup (pointer/u16* etc.; see schema)
    uint8_t   key_bytes[2];  // up to first used offset for lookup
    uint32_t  notify_count;  // at +0x02 — triggers queued notification when non-zero
    // ...
    // Parameters consumed by finalize/commit routine
    uint8_t   finalize_args[]; // from +0x0A and subsequent fields per schema
};

#pragma pack(pop)
```

Notes:
- Pattern mirrors other “parse → maybe queue → finalize” handlers in this block.
- Exact field widths can be locked in by decoding &DAT_142512E70’s typecodes (0x02/0x17/0x11/0x12/0x14/0x15) and cross-checking a few captures.
