# SMSG_0x0027 — Small Status/Flag Message (Variants 0x0003 and 0x0004)

Direction: Server → Client  
Observed sizes: 2 and 6 bytes  
Endianness: Little endian

## Summary

SMSG_0x0027 appears frequently alongside movement/skill activity. Two small, stable variants are observed:

- Subtype 0x0003 (size 2): minimal control/tick/flag with no payload.
- Subtype 0x0004 (size 6): carries a small u16 value; trailing u16 is zero (reserved/alignment).

Handler mapping via SrvMsgDispatcher selector (+0x18) is pending; on-wire layouts are stable for consumers.

## Layouts

### Size = 2 (Subtype 0x0003)

Offset | Type    | Name     | Notes
------ | ------- | -------- | -----
0x00   | u16     | subtype  | Always 0x0003 in observed samples

Hex example:
- `03 00`

### Size = 6 (Subtype 0x0004)

Offset | Type    | Name     | Notes
------ | ------- | -------- | -----
0x00   | u16     | subtype  | Always 0x0004 in observed samples
0x02   | u16     | value    | Small code/ID. Examples: 0x0047, 0x006F, 0x0048, 0x00C9, 0x0051
0x04   | u16     | zero     | 0x0000 in all observed samples (reserved/alignment)

Hex examples:
- `04 00 47 00 00 00`
- `04 00 6F 00 00 00`
- `04 00 48 00 00 00`
- `04 00 C9 00 00 00`
- `04 00 51 00 00 00`

## Evidence (from provided logs)

Size=2 (0x0003), repeated:
- `14:55:15.898 [R] 03 00`
- `14:55:25.940 [R] 03 00`
- `14:55:35.896 [R] 03 00`
- `14:55:45.894 [R] 03 00`
- `14:56:05.892 [R] 03 00`
- `14:55:56.017 [R] 03 00` (many occurrences)

Size=6 (0x0004) with varying value:
- `14:55:15.965 [R] 04 00 47 00 00 00`
- `14:55:26.007 [R] 04 00 6F 00 00 00`
- `14:55:35.963 [R] 04 00 48 00 00 00`
- `14:55:56.084 [R] 04 00 C9 00 00 00`
- `14:56:05.976 [R] 04 00 51 00 00 00`

## Behavior / Semantics (Hypotheses)

- Subtype 0x0003: Lightweight periodic flag/ack or minimal status tick. No payload.
- Subtype 0x0004: Broadcast of a small state/ID code in `value`. The trailing `zero` likely aligns or serves as a reserved field.
- Appears around normal interaction activity (skills, movement) and interleaves with TIME_SYNC (0x003F).

## Mapping Status

- The exact handler for `SMSG_0x0027` must be discovered via dynamic analysis (e.g., setting a breakpoint at `"Gw2-64.exe"+FD1ACD` within `Gs2c_SrvMsgDispatcher` and observing the `RAX` register when this opcode is processed). This page focuses on stable on-wire layout for immediate consumption, as the parsing logic is handled by `Msg_ParseAndDispatch_BuildArgs` based on a schema.

## Proposed C-style structs

```cpp
#pragma pack(push, 1)

// Size = 2
struct smsg_0027_v3 {
    uint16_t subtype;  // == 0x0003
};

// Size = 6
struct smsg_0027_v4 {
    uint16_t subtype;  // == 0x0004
    uint16_t value;    // examples: 0x0047, 0x006F, 0x0048, 0x00C9, 0x0051
    uint16_t zero;     // observed as 0x0000
};

#pragma pack(pop)
```

## Confidence

- Layout confidence: High (multiple samples, consistent structure).
- Semantic naming: Medium (exact meaning of `value` in 0x0004 is not yet confirmed).
- Mapping (handler address): Pending.
